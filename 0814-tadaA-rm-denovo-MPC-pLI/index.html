<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>yang's blog</title><meta name="author" content=""><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><meta name="generator" content="Hexo 4.0.0"></head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/">yang's blog</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/#Publications"> Publications</a></li><li class="menus_item"><a class="site-page" href="/"> About</a></li><li class="menus_item"><a class="site-page" href="https://phower.me" target="_blank" rel="noopener"> Blog</a></li></ul></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/profile.png'" alt="avatar"></div><div class="author-discrip"><h3>Yang Fu</h3><p class="author-bio">Your biography can be writed down here.</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-icons"><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-stack-overflow" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fab fa-weibo" aria-hidden="true"></i></a></li><li><a class="social-icon" href="/" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i></a></li></ul><ul class="social-links"><li><a class="e-social-link" href="/" target="_blank"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span>Google Scholar</span></a></li><li><a class="e-social-link" href="/" target="_blank"><i class="fab fa-orcid" aria-hidden="true"></i><span>ORCID</span></a></li></ul></div><a class="cv-links" href="/attaches/CV.pdf" target="_blank"><i class="fas fa-file-pdf" aria-hidden="true"><span>My Detail CV.</span></i></a></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><h2 class="page-title">test</h2><article><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library(tadaA)</span><br><span class="line">setwd(&quot;/storage11_7T/fuy/TADA-A/db/MS_data&quot;)</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">system.time(compact_data &lt;- TADA_A_read_info_by_chunks(</span><br><span class="line">mut_files = &quot;/storage11_7T/fuy/TADA-A/cell_DNM_allele.bed&quot;,</span><br><span class="line">    </span><br><span class="line">window_file = &quot;windows_partition/cd_windows_with_div_score.bed&quot;,</span><br><span class="line">    </span><br><span class="line">mutrate_scaling_files = c(&quot;/storage11_7T/fuy/TADA-A/cell_DNM_cd_windows_mutrate_with_div_score_scaling_file_for_test_DNM.txt&quot;),  </span><br><span class="line">    </span><br><span class="line">sample_sizes = 8609,</span><br><span class="line">    </span><br><span class="line">gene_prior_file = &quot;prior/uniform_gene_prior.txt&quot;,</span><br><span class="line">    </span><br><span class="line">nonAS_noncoding_annotations = NA, # c(</span><br><span class="line">#                                  &quot;/storage11_7T/fuy/TADA-A/annotation/ccr/ccrs.allchrom.gt90.bed&quot;),</span><br><span class="line">                                #&quot;/storage11_7T/fuy/TADA-A/annotation/ccr/chr_ccr_gt95_syn_rm.bed&quot;),</span><br><span class="line"></span><br><span class="line">AS_noncoding_annotations = list(</span><br><span class="line">####################### WES denovo ptv ############################    </span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/pLI/denovo_pLI_snv_alt_A.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/denovo_pLI_snv_alt_C.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/denovo_pLI_snv_alt_G.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/denovo_pLI_snv_alt_A.bed&quot;),</span><br><span class="line">    </span><br><span class="line">####################### gnomad lof ############################    </span><br><span class="line">c(&quot;/storage11_7T/fuy/TADA-A/annotation/gnomad/gnomad.v2.1.1.all_lofs_snv_alt_A.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/gnomad/gnomad.v2.1.1.all_lofs_snv_alt_C.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/gnomad/gnomad.v2.1.1.all_lofs_snv_alt_G.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/gnomad/gnomad.v2.1.1.all_lofs_snv_alt_T.bed&quot;), </span><br><span class="line">    </span><br><span class="line">####################### gnomad PTV tiers ############################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt09_gnomad.v2.1.1.all_lofs_snv_alt_A.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt09_gnomad.v2.1.1.all_lofs_snv_alt_C.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt09_gnomad.v2.1.1.all_lofs_snv_alt_G.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt09_gnomad.v2.1.1.all_lofs_snv_alt_T.bed&quot;)</span><br><span class="line">    </span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_05_995_gnomad.v2.1.1.all_lofs_snv_alt_A.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_05_995_gnomad.v2.1.1.all_lofs_snv_alt_C.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_05_995_gnomad.v2.1.1.all_lofs_snv_alt_G.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_05_995_gnomad.v2.1.1.all_lofs_snv_alt_T.bed&quot;),</span><br><span class="line">    </span><br><span class="line">c(&quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_lt05_gnomad.v2.1.1.all_lofs_snv_alt_A.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_lt05_gnomad.v2.1.1.all_lofs_snv_alt_C.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_lt05_gnomad.v2.1.1.all_lofs_snv_alt_G.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_lt05_gnomad.v2.1.1.all_lofs_snv_alt_T.bed&quot;),</span><br><span class="line">    </span><br><span class="line">c(&quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt_995_gnomad.v2.1.1.all_lofs_snv_alt_A.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt_995_gnomad.v2.1.1.all_lofs_snv_alt_C.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt_995_gnomad.v2.1.1.all_lofs_snv_alt_G.bed&quot;,</span><br><span class="line"> &quot;/storage11_7T/fuy/TADA-A/annotation/pLI/pLI_nlt_995_gnomad.v2.1.1.all_lofs_snv_alt_T.bed&quot;),</span><br><span class="line">    </span><br><span class="line">####################### annova missense ############################</span><br><span class="line">#                       c(&quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_missense_alt_A.bed&quot;, </span><br><span class="line">#                           &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_missense_alt_C.bed&quot;, </span><br><span class="line">#                           &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_missense_alt_G.bed&quot;,</span><br><span class="line">#                           &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_missense_alt_T.bed&quot;),</span><br><span class="line"></span><br><span class="line">####################### annova lof ############################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_lof_alt_A.bed&quot;, </span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_lof_alt_C.bed&quot;, </span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_lof_alt_G.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_lof_alt_T.bed&quot;),</span><br><span class="line"></span><br><span class="line">####################### annova syn ############################</span><br><span class="line"># #                               c(&quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_cd_syn_alt_A.bed&quot;,</span><br><span class="line"># #                                 &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_cd_syn_alt_C.bed&quot;,</span><br><span class="line"># #                                 &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_cd_syn_alt_G.bed&quot;,</span><br><span class="line"># #                                 &quot;/storage11_7T/fuy/TADA-A/annotation/driverMAPS/all_cd_syn_alt_T.bed&quot;),</span><br><span class="line">    </span><br><span class="line">####################### CADD ############################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/CADD/whole_genome_SNVs_gt15_altA_within_10kb_and_promoter_no_utr.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/CADD/whole_genome_SNVs_gt15_altC_within_10kb_and_promoter_no_utr.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/CADD/whole_genome_SNVs_gt15_altG_within_10kb_and_promoter_no_utr.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/CADD/whole_genome_SNVs_gt15_altT_within_10kb_and_promoter_no_utr.bed&quot;),    </span><br><span class="line"></span><br><span class="line">####################### RBP ############################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/RBP-VarDB/RBP.all.bed.merge_overlap_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altA.bed.merge_in_coding_windows.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/RBP-VarDB/RBP.all.bed.merge_overlap_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altC.bed.merge_in_coding_windows.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/RBP-VarDB/RBP.all.bed.merge_overlap_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altG.bed.merge_in_coding_windows.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/RBP-VarDB/RBP.all.bed.merge_overlap_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altT.bed.merge_in_coding_windows.bed&quot;),</span><br><span class="line"></span><br><span class="line">###################### MVP ###########################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/MVP/chr_MVP_all_rare_missense_pathogen_rank_gt_75_alt_A.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MVP/chr_MVP_all_rare_missense_pathogen_rank_gt_75_alt_C.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MVP/chr_MVP_all_rare_missense_pathogen_rank_gt_75_alt_G.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MVP/chr_MVP_all_rare_missense_pathogen_rank_gt_75_alt_T.bed&quot;),</span><br><span class="line">    </span><br><span class="line">########################### primateAI ################################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/primateAI/chr_primateAI_exome_mutation_pathogen_rank_gt_80_alt_A.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/primateAI/chr_primateAI_exome_mutation_pathogen_rank_gt_80_alt_C.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/primateAI/chr_primateAI_exome_mutation_pathogen_rank_gt_80_alt_G.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/primateAI/chr_primateAI_exome_mutation_pathogen_rank_gt_80_alt_T.bed&quot;),</span><br><span class="line"></span><br><span class="line"># ########################## spidex #############################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/db/MS_data/annota/spidex_public_noncommercial_v1_0.tab_alt_A_lower10pct.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/db/MS_data/annota/spidex_public_noncommercial_v1_0.tab_alt_C_lower10pct.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/db/MS_data/annota/spidex_public_noncommercial_v1_0.tab_alt_G_lower10pct.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/db/MS_data/annota/spidex_public_noncommercial_v1_0.tab_alt_T_lower10pct.bed&quot;),</span><br><span class="line"></span><br><span class="line">############## MPC ##################</span><br><span class="line">c(&quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/fordist_constraint_official_mpc_values_v2_MPC_gt2_altA.sorted.merged_in_coding_windows.bed&quot;,</span><br><span class="line">&quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/fordist_constraint_official_mpc_values_v2_MPC_gt2_altC.sorted.merged_in_coding_windows.bed&quot;,</span><br><span class="line">&quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/fordist_constraint_official_mpc_values_v2_MPC_gt2_altG.sorted.merged_in_coding_windows.bed&quot;,</span><br><span class="line">&quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/fordist_constraint_official_mpc_values_v2_MPC_gt2_altT.sorted.merged_in_coding_windows.bed&quot;)</span><br><span class="line">    </span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC12_alt_A.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC12_alt_C.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC12_alt_G.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC12_alt_T.bed&quot;),    </span><br><span class="line">    </span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC01_alt_A.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC01_alt_C.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC01_alt_G.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/MPC_score/MPC01_alt_T.bed&quot;)</span><br><span class="line">    </span><br><span class="line">#################### ribosnitch ###########################</span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altA.bed.merge.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altC.bed.merge.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altG.bed.merge.bed&quot;,</span><br><span class="line"># &quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.1.altT.bed.merge.bed&quot;),</span><br><span class="line">    </span><br><span class="line"># c(&quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altA_in_coding_windows.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altC_in_coding_windows.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altG_in_coding_windows.bed&quot;,</span><br><span class="line">#  &quot;/storage11_7T/fuy/TADA-A/annotation/ribosnitch/hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altT_in_coding_windows.bed&quot;),</span><br><span class="line">    </span><br><span class="line">###################### CLIPdb ############################</span><br><span class="line">#c(&quot;/storage11_7T/fuy/TADA-A/annotation/CLIPdb/human_combine.merged_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altA.bed&quot;,</span><br><span class="line">#&quot;/storage11_7T/fuy/TADA-A/annotation/CLIPdb/human_combine.merged_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altC.bed&quot;,</span><br><span class="line">#&quot;/storage11_7T/fuy/TADA-A/annotation/CLIPdb/human_combine.merged_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altG.bed&quot;,</span><br><span class="line">#&quot;/storage11_7T/fuy/TADA-A/annotation/CLIPdb/human_combine.merged_hg19_refGenes_exons.gtf.lg.transc.fa.RNAsnpM3.bed.abspos.p0.05.merged.altT.bed&quot;)</span><br><span class="line">    </span><br><span class="line">), </span><br><span class="line">                    </span><br><span class="line"></span><br><span class="line">report_proportion = 18665/18665,</span><br><span class="line">#chunk_partition_num =1,</span><br><span class="line">chunk = 6,</span><br><span class="line">node_n = 6,</span><br><span class="line">mutrate_ref_files = c(&quot;mutrate/Example_windows_extended_1bp_for_getting_base_level_mutrate.bed.fasta.tri.alt_A.mutrate.bw&quot;,</span><br><span class="line">                   &quot;mutrate/Example_windows_extended_1bp_for_getting_base_level_mutrate.bed.fasta.tri.alt_C.mutrate.bw&quot;,</span><br><span class="line">                   &quot;mutrate/Example_windows_extended_1bp_for_getting_base_level_mutrate.bed.fasta.tri.alt_G.mutrate.bw&quot;,</span><br><span class="line">                   &quot;mutrate/Example_windows_extended_1bp_for_getting_base_level_mutrate.bed.fasta.tri.alt_T.mutrate.bw&quot;)</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">saveRDS(compact_data,paste0(&quot;/storage11_7T/fuy/TADA-A/annotation/&quot;,Sys.Date(),&quot;_cell_DNM_uniform_prior_test_selected_compact.rds&quot;))</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tm = proc.time()</span><br><span class="line">RR = TADA_A_RR_estimate(data = compact_data$base_info, selected_annotations = seq(1,4), </span><br><span class="line">         gene_prior_file = &quot;prior/uniform_gene_prior.txt&quot;, optimization_iteration =2000)</span><br><span class="line">proc.time() - tm</span><br><span class="line">saveRDS(RR,paste0(&quot;/storage11_7T/fuy/TADA-A/annotation/&quot;,Sys.Date(),&quot;_cell_DNM_uniform_prior_test_selected_RR.rds&quot;))</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RR$rr_report</span><br></pre></td></tr></table></figure>


<table>
<caption>A data.frame: 5 × 3</caption>
<thead>
    <tr><th scope="col">relative_risk</th><th scope="col">lower_bound</th><th scope="col">upper_bournd</th></tr>
    <tr><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td> 7.3049574</td><td>  7.139237</td><td> 7.470678</td></tr>
    <tr><td>-1.7057071</td><td>-12.668831</td><td> 9.257417</td></tr>
    <tr><td> 0.7866599</td><td>-10.179371</td><td>11.752691</td></tr>
    <tr><td>-6.1001062</td><td>       NaN</td><td>      NaN</td></tr>
    <tr><td> 1.2922336</td><td>  1.022991</td><td> 1.561477</td></tr>
</tbody>
</table>




<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">options(scipen=200)</span><br><span class="line">tm = proc.time()</span><br><span class="line">BF = TADA_A_get_BFs(data = compact_data$base_info,</span><br><span class="line">               selected_annotations = seq(1,5), </span><br><span class="line">               rr = RR$rr_report$relative_risk, </span><br><span class="line">               additional_BF_file = c(&quot;/storage11_7T/fuy/TADA-A/annotation/cd_BF/uniform_cd_BFs.txt&quot;), </span><br><span class="line">               TADA_p0 = 0.94)</span><br><span class="line"></span><br><span class="line">g_BF = BF$gene_BF_table</span><br><span class="line">g_BF = g_BF[order(g_BF$FDR_all),]</span><br><span class="line">g_BF2 = g_BF[g_BF$FDR_all &lt;= 0.1,]</span><br><span class="line">nrow(g_BF2)</span><br><span class="line">proc.time() - tm</span><br></pre></td></tr></table></figure>
</article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/#Publications"> Publications</a></li><li class="nav_item"><a class="nav-page" href="/"> About</a></li><li class="nav_item"><a class="nav-page" href="https://phower.me" target="_blank" rel="noopener"> Blog</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2020 by </div><div class="theme-info">Powered by <a href="https://hexo.io" target="_blank" rel="nofollow noopener">Hexo</a> & <a href="https://github.com/PhosphorW/hexo-theme-academia" target="_blank" rel="nofollow noopener">Academia Theme</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/js/main.js"></script></body></html>